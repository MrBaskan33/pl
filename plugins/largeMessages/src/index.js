(function(i,r,f,a,m,E,h,c,g){"use strict";function M(){return g.useProxy(a.storage),React.createElement(c.ErrorBoundary,null,React.createElement(h.ReactNative.ScrollView,null,React.createElement(c.Forms.FormSwitchRow,{label:"Split messages on words instead of newlines",subLabel:"Results in the lowest amount of messages",onValueChange:function(s){return a.storage.splitOnWords=s},value:a.storage.splitOnWords})))}a.storage.splitOnWords??=!1;function S(s){return new Promise(function(o){return setTimeout(o,s)})}function _(s,o){const n=[];return a.storage.splitOnWords||n.push(s.split(`
`).reduce(function(e,t){return e.length+t.length+2>o?(n.push(e),t+`
`):e?e+t+`
`:t+`
`},"")),n.length&&!n.some(function(e){return e.length>o})?n.map(function(e){return e.trim()}):(n.length=0,n.push(s.split(" ").reduce(function(e,t){return e.length+t.length+2>o?(n.push(e),t+" "):e?e+t+" ":t+" "},"")),n.some(function(e){return e.length>o})?!1:n.map(function(e){return e.trim()}))}var p={onLoad(){const s=r.findByStoreName("ChannelStore"),o=r.findByProps("sendMessage","editMessage"),n=r.findByProps("MAX_MESSAGE_LENGTH"),e=r.findByStoreName("UserStore").getCurrentUser()?.premiumType===2?4e3:2e3;n.MAX_MESSAGE_LENGTH=2**30,n.MAX_MESSAGE_LENGTH_PREMIUM=2**30,f.before("sendMessage",o,function(t){const[l,{content:d}]=t;if(d?.length<e)return;const u=_(d,e);if(!u)return t[1].content="",E.showToast("Failed to split message",m.getAssetIDByName("Small"));t[1].content=u.shift();const v=s.getChannel(l);(async function(){for(const A of u)await S(Math.max(v.rateLimitPerUser,1e3)),await o._sendMessage(l,{invalidEmojis:t[1].invalidEmojis,validNonShortcutEmojis:t[1].validNonShortcutEmojis,tts:!1,content:A},{})})()})},onUnload:function(){const s=r.findByProps("MAX_MESSAGE_LENGTH");s.MAX_MESSAGE_LENGTH=2e3,s.MAX_MESSAGE_LENGTH_PREMIUM=4e3},settings:M};return i.default=p,Object.defineProperty(i,"__esModule",{value:!0}),i})({},vendetta.metro,vendetta.patcher,vendetta.plugin,vendetta.ui.assets,vendetta.ui.toasts,vendetta.metro.common,vendetta.ui.components,vendetta.storage);
