(function(d,t,s,w,y,F){"use strict";const{FormRow:f,FormSection:h,FormDivider:E,FormTitle:b}=F.Forms,m=t.findByProps("getToken","setToken"),v=t.findByProps("getCurrentUser"),R=t.findByProps("getDeviceId"),l=12,c=16;function p(){return R?.getDeviceId?.()||"fallback-device-id"}async function g(a,r){const e=await crypto.subtle.importKey("raw",new TextEncoder().encode(a),"PBKDF2",!1,["deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:r,iterations:1e5,hash:"SHA-256"},e,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}async function T(a,r){const e=crypto.getRandomValues(new Uint8Array(c)),o=crypto.getRandomValues(new Uint8Array(l)),n=await g(r,e),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:o},n,new TextEncoder().encode(a)),u=new Uint8Array(c+l+i.byteLength);return u.set(e,0),u.set(o,c),u.set(new Uint8Array(i),c+l),btoa(String.fromCharCode(...u))}async function A(a,r){const e=Uint8Array.from(atob(a),function(K){return K.charCodeAt(0)}),o=e.slice(0,c),n=e.slice(c,c+l),i=e.slice(c+l),u=await g(r,o),x=await crypto.subtle.decrypt({name:"AES-GCM",iv:n},u,i);return new TextDecoder().decode(x)}async function C(){const a=m.getToken(),r=p(),e=v.getCurrentUser();if(!a||!e)return;const o=await T(a,r);s.storage.accounts=s.storage.accounts||[],s.storage.accounts.find(function(n){return n.id===e.id})||(s.storage.accounts.push({id:e.id,name:e.username,token:o}),y.showToast(`Hesap "${e.username}" kaydedildi`))}function D(){const a=p(),[r,e]=t.React.useState(s.storage.accounts??[]),o=async function(n){try{const i=await A(n.token,a);m.setToken(i),y.showToast(`"${n.name}" hesab\u0131na ge\xE7iliyor...`),setTimeout(function(){return location.reload()},1e3)}catch{y.showToast("Ge\xE7i\u015F yap\u0131lamad\u0131. \u015Eifreleme hatas\u0131.")}};return t.React.createElement(t.React.Fragment,null,t.React.createElement(b,{title:"Kay\u0131tl\u0131 Hesaplar"}),r.length===0?t.React.createElement(f,{label:"Kay\u0131tl\u0131 hesap yok."}):r.map(function(n,i){return t.React.createElement(f,{key:i,label:n.name,subLabel:`ID: ${n.id}`,onPress:function(){return o(n)}})}))}var k={onLoad(){C()},onUnload(){},getSettingsPanel(){return function(){return t.React.createElement(t.React.Fragment,null,t.React.createElement(h,{title:"Hesap De\u011Fi\u015Ftirici"},t.React.createElement(f,{label:"Hesap De\u011Fi\u015Ftir",subLabel:"Kay\u0131tl\u0131 hesaplar\u0131 g\xF6r\xFCnt\xFCle ve ge\xE7i\u015F yap",onPress:function(){return w.showModal("Hesap De\u011Fi\u015Ftir",D)}}),t.React.createElement(E,null)))}}};return d.default=k,Object.defineProperty(d,"__esModule",{value:!0}),d})({},vendetta.metro,vendetta.plugin,vendetta.ui.modal,vendetta.ui.toasts,vendetta.ui.components);
